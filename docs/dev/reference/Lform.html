<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Hypothesis matrix generated by expressions — Lform • spida2</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Hypothesis matrix generated by expressions — Lform"><meta name="description" content="Creates an L matrix using expressions evaluated in 'data' for each column of
the L matrix
Creates an L matrix using expressions evaluated in 'data' for each column of
the L matrix"><meta property="og:description" content="Creates an L matrix using expressions evaluated in 'data' for each column of
the L matrix
Creates an L matrix using expressions evaluated in 'data' for each column of
the L matrix"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">spida2</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.2.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/spida2.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/generalParametricSplines_v2.html">General Parametric Splines in carEx v.2</a></li>
    <li><a class="dropdown-item" href="../articles/generalParametricSplines.html">General Parametric Splines in carEx</a></li>
    <li><a class="dropdown-item" href="../articles/pdInd.html">pdInd</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gmonette/spida2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Hypothesis matrix generated by expressions</h1>
      <small class="dont-index">Source: <a href="https://github.com/gmonette/spida2/blob/HEAD/R/wald-lrt.R" class="external-link"><code>R/wald-lrt.R</code></a>, <a href="https://github.com/gmonette/spida2/blob/HEAD/R/wald.R" class="external-link"><code>R/wald.R</code></a></small>
      <div class="d-none name"><code>Lform.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates an L matrix using expressions evaluated in 'data' for each column of
the L matrix</p>
<p>Creates an L matrix using expressions evaluated in 'data' for each column of
the L matrix</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Lform</span><span class="op">(</span><span class="va">fit</span>, <span class="va">form</span>, data <span class="op">=</span> <span class="fu"><a href="getData.html">getData</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">Lform</span><span class="op">(</span><span class="va">fit</span>, <span class="va">form</span>, data <span class="op">=</span> <span class="fu"><a href="getData.html">getData</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-fit">fit<a class="anchor" aria-label="anchor" href="#arg-fit"></a></dt>
<dd><p>a fitted model with a 'getFix' method.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>the data frame in which expressions are evaluated.</p></dd>


<dt id="arg-expr-list">expr.list<a class="anchor" aria-label="anchor" href="#arg-expr-list"></a></dt>
<dd><p>a list of expressions with one component for each column
(or groups of columns) of the hypothesis matrix corresponding to each term
of the model. A term with multiple degrees of freedom can either be
generated as separate single terms or with an expression that evaluates to a
suitable matrix.</p></dd>


<dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>as an argument of <code>M</code>, a one-sided formula defining a
main effect or an interaction term involving factors.</p></dd>


<dt id="arg-expr">expr<a class="anchor" aria-label="anchor" href="#arg-expr"></a></dt>
<dd><p>as an argument of <code>M</code>, an expression that can be evaluated
in each row of <code>data</code> to form element(s) of the corresponding row of
<code>L</code>.  formula defining a main effect or an interaction term involving
factors.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>hypothesis matrix</p>
<p>hypothesis matrix</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If <code>Lform</code> is called with only a <code>fit</code> argument, it outputs code
consisting of an expression that would, if used as the <code>fmla</code> argument
to <code>Lform</code> would generate the full design matrix for the linear model.</p>
<p>If <code>Lform</code> is called with two or three arguments, it generates a
hypothesis matrix by evaluating the expressions in <code>form</code> in the
environment <code>data</code>. The function <code>M</code> is designed to facilitate the
generation of blocks of the hypothesis matrix corresponding to main effects
or interaction effects of factors.</p>
<p><code> Creates a linear hypothesis
matrix, i.e. an L matrix, using formulas evaluated in 'data' for each column
of the L matrix. This approach lends itself to creating hypotheses and
estimates based on data such as partial derivatives with respect to
variables evaluated at each data point.An example is the estimation of growth rates in longitudinal models.library(car) library(spida) fit &lt;- lm( income ~ (education + I(education^2)
)* type, Prestige) summary(fit). . .  Coefficients: Estimate Std. Error t value Pr(&gt;|t|) (Intercept) 891.3
23889.1 0.037 0.97032 education 210.0 5638.8 0.037 0.97037 I(education^2)
38.3 328.3 0.117 0.90740 typeprof 191523.2 63022.0 3.039 0.00312 ** typewc
25692.3 73888.0 0.348 0.72887 education:typeprof -28133.0 10236.0 -2.748
0.00725 ** education:typewc -4485.4 14007.9 -0.320 0.74956
I(education^2):typeprof 1017.5 451.8 2.252 0.02679 * I(education^2):typewc
170.9 671.6 0.255 0.79967 . . .# estimate the marginal value of occupation for each occupation in the data
setL &lt;- list( 'marginal value of education' =Lform( fit, form = list(
0,1,2*education, 0,0, type == 'prof', type == 'wc', 2*education
*(type=='prof'), 2* education * (type == 'wc')), data = Prestige)) wald(
fit, L ) chat &lt;- coef( wald( fit, L ), se = 2) xyplot( coef +coefp+coefm ~
education | type, cbind(Prestige,chat)[order(Prestige$education),], type =
'l') xyplot( chat~ education | type, Prestige) </code></p>
<p>If <code>Lform</code> is called with only a <code>fit</code> argument, it outputs code
consisting of an expression that would, if used as the <code>fmla</code> argument
to <code>Lform</code> would generate the full design matrix for the linear model.</p>
<p>If <code>Lform</code> is called with two or three arguments, it generates a
hypothesis matrix by evaluating the expressions in <code>form</code> in the
environment <code>data</code>. The function <code>M</code> is designed to facilitate the
generation of blocks of the hypothesis matrix corresponding to main effects
or interaction effects of factors.</p>
<p><code> Creates a linear hypothesis
matrix, i.e. an L matrix, using formulas evaluated in 'data' for each column
of the L matrix. This approach lends itself to creating hypotheses and
estimates based on data such as partial derivatives with respect to
variables evaluated at each data point.An example is the estimation of growth rates in longitudinal models.library(car) library(spida) fit &lt;- lm( income ~ (education + I(education^2)
)* type, Prestige) summary(fit). . .  Coefficients: Estimate Std. Error t value Pr(&gt;|t|) (Intercept) 891.3
23889.1 0.037 0.97032 education 210.0 5638.8 0.037 0.97037 I(education^2)
38.3 328.3 0.117 0.90740 typeprof 191523.2 63022.0 3.039 0.00312 ** typewc
25692.3 73888.0 0.348 0.72887 education:typeprof -28133.0 10236.0 -2.748
0.00725 ** education:typewc -4485.4 14007.9 -0.320 0.74956
I(education^2):typeprof 1017.5 451.8 2.252 0.02679 * I(education^2):typewc
170.9 671.6 0.255 0.79967 . . .# estimate the marginal value of occupation for each occupation in the data
setL &lt;- list( 'marginal value of education' =Lform( fit, form = list(
0,1,2*education, 0,0, type == 'prof', type == 'wc', 2*education
*(type=='prof'), 2* education * (type == 'wc')), data = Prestige)) wald(
fit, L ) chat &lt;- coef( wald( fit, L ), se = 2) xyplot( coef +coefp+coefm ~
education | type, cbind(Prestige,chat)[order(Prestige$education),], type =
'l') xyplot( chat~ education | type, Prestige) </code></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="wald.html">wald</a>,Leff</code> and <code><a href="Lfx.html">Lfx</a></code> for a new
improved but experimental version.</p>
<p><code><a href="wald.html">wald</a>,Leff</code> and <code><a href="Lfx.html">Lfx</a></code> for a new
improved but experimental version.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>

    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Georges Monette.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>


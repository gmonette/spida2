<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Wald function producing a data frame for graphing — walddf • spida2</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Wald function producing a data frame for graphing — walddf"><meta name="description" content="A version of the wald function that produces a data frame directly, analogously to as.data.frame(wald(...))
A version of the wald function that produces a data frame directly, analogously to as.data.frame(wald(...))"><meta property="og:description" content="A version of the wald function that produces a data frame directly, analogously to as.data.frame(wald(...))
A version of the wald function that produces a data frame directly, analogously to as.data.frame(wald(...))"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">spida2</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.2.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/spida2.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/generalParametricSplines_v2.html">General Parametric Splines in carEx v.2</a></li>
    <li><a class="dropdown-item" href="../articles/generalParametricSplines.html">General Parametric Splines in carEx</a></li>
    <li><a class="dropdown-item" href="../articles/pdInd.html">pdInd</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gmonette/spida2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Wald function producing a data frame for graphing</h1>
      <small class="dont-index">Source: <a href="https://github.com/gmonette/spida2/blob/HEAD/R/wald-lrt.R" class="external-link"><code>R/wald-lrt.R</code></a>, <a href="https://github.com/gmonette/spida2/blob/HEAD/R/wald.R" class="external-link"><code>R/wald.R</code></a></small>
      <div class="d-none name"><code>walddf.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A version of the wald function that produces a data frame directly, analogously to <code>as.data.frame(wald(...))</code></p>
<p>A version of the wald function that produces a data frame directly, analogously to <code>as.data.frame(wald(...))</code></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">walddf</span><span class="op">(</span></span>
<span>  <span class="va">fit</span>,</span>
<span>  Llist <span class="op">=</span> <span class="st">""</span>,</span>
<span>  clevel <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  full <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  fixed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  invert <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"svd"</span>,</span>
<span>  df <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  se <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  sep <span class="op">=</span> <span class="st">""</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">walddf</span><span class="op">(</span></span>
<span>  <span class="va">fit</span>,</span>
<span>  Llist <span class="op">=</span> <span class="st">""</span>,</span>
<span>  clevel <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  full <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  fixed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  invert <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"svd"</span>,</span>
<span>  df <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  se <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  sep <span class="op">=</span> <span class="st">""</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-fit">fit<a class="anchor" aria-label="anchor" href="#arg-fit"></a></dt>
<dd><p>a model for which a <code>getFix</code> method exists.</p></dd>


<dt id="arg-llist">Llist<a class="anchor" aria-label="anchor" href="#arg-llist"></a></dt>
<dd><p>a hypothesis matrix or a pattern to be matched or a list of
these</p></dd>


<dt id="arg-clevel">clevel<a class="anchor" aria-label="anchor" href="#arg-clevel"></a></dt>
<dd><p>level for confidence intervals. No confidence intervals if clevel is NULL</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>data frame used as 'data' attribute fot list elements returned only if
the corresponding element of <code>Llist</code> has a NULL data attribute</p></dd>


<dt id="arg-debug">debug<a class="anchor" aria-label="anchor" href="#arg-debug"></a></dt>
<dd><p>(default FALSE) produce verbose information</p></dd>


<dt id="arg-full">full<a class="anchor" aria-label="anchor" href="#arg-full"></a></dt>
<dd><p>if TRUE, the hypothesis matrix is the model matrix for
<code>fit</code> such that the estimated coefficients are the predicted values for
the fixed portion of the model. This is designed to allow the calculation of
standard errors for models for which the <code>predict</code> method does not
provide them.</p></dd>


<dt id="arg-fixed">fixed<a class="anchor" aria-label="anchor" href="#arg-fixed"></a></dt>
<dd><p>if <code>Llist</code> is a character to be used a regular expression,
if <code>fixed</code> is TRUE <code>Llist</code> is interpreted literally, i.e.
characters that have a special meaning in regular expressions are
interpreted literally.</p></dd>


<dt id="arg-invert">invert<a class="anchor" aria-label="anchor" href="#arg-invert"></a></dt>
<dd><p>if <code>Llist</code> is a character to be used a regular
expression, <code>invert == TRUE</code> causes the matches to be inverted so that
coefficients that do not match will be selected.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>'svd' (current default) or 'qr' is the method used to find the
full rank version of the hypothesis matrix.  'svd' has correctly identified
the rank of a large hypothesis matrix where 'qr' has failed.</p></dd>


<dt id="arg-se">se<a class="anchor" aria-label="anchor" href="#arg-se"></a></dt>
<dd><p>a vector with the multiples of standard error used to generate lower and upper limits. 'names(se)'
is appended to 'L' and 'U' to label the variables.</p></dd>


<dt id="arg-which">which<a class="anchor" aria-label="anchor" href="#arg-which"></a></dt>
<dd><p>selects elements of 'obj' to turn to a data.frame.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame with estimated coefficient, standard error, and, optionally, upper and lower limits and
the variables included the 'data' element of 'obj' if present.
If <code>length(which) &gt; 1</code>, the returned object is a list of data frames.</p>
<p>A data frame with estimated coefficient, standard error, and, optionally, upper and lower limits and
the variables included the 'data' element of 'obj' if present.
If <code>length(which) &gt; 1</code>, the returned object is a list of data frames.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">###</span></span></span>
<span class="r-in"><span><span class="co">### Using walddf to create and plot a data frame with predicted values</span></span></span>
<span class="r-in"><span><span class="co">###</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">hs</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span> <span class="va"><a href="https://svn.r-project.org/R-packages/trunk/nlme/" class="external-link">nlme</a></span> <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html" class="external-link">lme</a></span><span class="op">(</span><span class="va">mathach</span> <span class="op">~</span> <span class="op">(</span><span class="va">ses</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">ses</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="va">Sex</span> <span class="op">*</span> <span class="va">Sector</span>, <span class="va">hs</span>, random <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span><span class="op">|</span><span class="va">school</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span> ses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">.1</span><span class="op">)</span>, Sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">hs</span><span class="op">$</span><span class="va">Sex</span><span class="op">)</span>, Sector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">hs</span><span class="op">$</span><span class="va">Sector</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">w</span> <span class="op">&lt;-</span> <span class="fu">walddf</span><span class="op">(</span><span class="va">fit</span>, <span class="fu"><a href="getX.html">getX</a></span><span class="op">(</span><span class="va">fit</span>,data<span class="op">=</span><span class="va">pred</span><span class="op">)</span><span class="op">)</span> <span class="co"># attaches data to wald.object so it can included in data frame</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://latticeextra.r-forge.r-project.org/" class="external-link">latticeExtra</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">coef</span> <span class="op">~</span> <span class="va">ses</span> <span class="op">|</span> <span class="va">Sector</span>, <span class="va">w</span>, groups <span class="op">=</span> <span class="va">Sex</span>,</span></span>
<span class="r-in"><span>     auto.key <span class="op">=</span> <span class="cn">T</span>, type <span class="op">=</span> <span class="st">'l'</span>,</span></span>
<span class="r-in"><span>     fit <span class="op">=</span> <span class="va">w</span><span class="op">$</span><span class="va">coef</span>,</span></span>
<span class="r-in"><span>     upper <span class="op">=</span> <span class="va">w</span><span class="op">$</span><span class="va">L</span>,</span></span>
<span class="r-in"><span>     lower <span class="op">=</span> <span class="va">w</span><span class="op">$</span><span class="va">U</span>,</span></span>
<span class="r-in"><span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     subscript <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>     <span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/layer.html" class="external-link">glayer</a></span><span class="op">(</span> <span class="fu"><a href="panel.fit.html">gpanel.fit</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="wald.html">wald</a></span><span class="op">(</span><span class="va">fit</span>, <span class="st">'ses'</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="wald.html">wald</a></span><span class="op">(</span> <span class="va">fit</span>, <span class="st">'Sex'</span><span class="op">)</span>  <span class="co"># sig. overall effect of Sex</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="wald.html">wald</a></span><span class="op">(</span> <span class="va">fit</span>, <span class="st">':Sex'</span><span class="op">)</span> <span class="co"># but no evidence of interaction with ses</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="wald.html">wald</a></span><span class="op">(</span> <span class="va">fit</span>, <span class="st">'\\^2'</span><span class="op">)</span> <span class="co"># nor of curvature</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># conditional effect of ses</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="getX.html">getX</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">###</span></span></span>
<span class="r-in"><span>  <span class="co">###  Effect of ses: Differentiating with respect to ses</span></span></span>
<span class="r-in"><span>  <span class="co">###</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">L</span> <span class="op">&lt;-</span> <span class="fu"><a href="Lfx.html">Lfx</a></span><span class="op">(</span><span class="va">fit</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>         <span class="fl">0</span>,</span></span>
<span class="r-in"><span>         <span class="fl">1</span>,</span></span>
<span class="r-in"><span>         <span class="fl">2</span> <span class="op">*</span> <span class="va">ses</span>,</span></span>
<span class="r-in"><span>         <span class="fl">0</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">0</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">2</span> <span class="op">*</span> <span class="va">ses</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">2</span> <span class="op">*</span> <span class="va">ses</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">0</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">2</span> <span class="op">*</span> <span class="va">ses</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="va">pred</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="wald.html">wald</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">L</span><span class="op">)</span>, <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">w</span> <span class="op">&lt;-</span> <span class="fu">walddf</span><span class="op">(</span><span class="va">fit</span>, <span class="va">L</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">coef</span> <span class="op">~</span> <span class="va">ses</span> <span class="op">|</span> <span class="va">Sector</span>, <span class="va">w</span>, groups <span class="op">=</span> <span class="va">Sex</span>,</span></span>
<span class="r-in"><span>     auto.key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="fl">2</span>, lines <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     type <span class="op">=</span> <span class="st">'l'</span>,</span></span>
<span class="r-in"><span>     fit <span class="op">=</span> <span class="va">w</span><span class="op">$</span><span class="va">coef</span>,</span></span>
<span class="r-in"><span>     upper <span class="op">=</span> <span class="va">w</span><span class="op">$</span><span class="va">L</span>,</span></span>
<span class="r-in"><span>     lower <span class="op">=</span> <span class="va">w</span><span class="op">$</span><span class="va">U</span>,</span></span>
<span class="r-in"><span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     ylab <span class="op">=</span> <span class="st">'estimate change in mathach per unit increase in ses'</span>,</span></span>
<span class="r-in"><span>     subscripts <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>     <span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/layer.html" class="external-link">glayer</a></span><span class="op">(</span> <span class="fu"><a href="panel.fit.html">gpanel.fit</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>     <span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/layer.html" class="external-link">layer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/panel.functions.html" class="external-link">panel.abline</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">0</span>,b<span class="op">=</span><span class="fl">0</span>,lwd <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span><span class="st">'black'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">###</span></span></span>
<span class="r-in"><span>  <span class="co">###  Difference in effect of ses between Sectors</span></span></span>
<span class="r-in"><span>  <span class="co">###</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">pred.d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span> ses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">.1</span><span class="op">)</span>, Sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">hs</span><span class="op">$</span><span class="va">Sex</span><span class="op">)</span>, Sector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">hs</span><span class="op">$</span><span class="va">Sector</span><span class="op">)</span>, Sector0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">hs</span><span class="op">$</span><span class="va">Sector</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">pred.d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">pred.d</span>, <span class="va">Sector</span> <span class="op">&gt;</span> <span class="va">Sector0</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pred.d</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">L</span> <span class="op">&lt;-</span> <span class="fu"><a href="Lfx.html">Lfx</a></span><span class="op">(</span><span class="va">fit</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>         <span class="fl">0</span>,</span></span>
<span class="r-in"><span>         <span class="fl">0</span>,</span></span>
<span class="r-in"><span>         <span class="fl">0</span> <span class="op">*</span> <span class="va">ses</span>,</span></span>
<span class="r-in"><span>         <span class="fl">0</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">0</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">0</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">0</span> <span class="op">*</span> <span class="va">ses</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">2</span> <span class="op">*</span> <span class="va">ses</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector0</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">0</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector0</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">2</span> <span class="op">*</span> <span class="va">ses</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="va">pred.d</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">w</span> <span class="op">&lt;-</span> <span class="fu">walddf</span><span class="op">(</span><span class="va">fit</span>, <span class="va">L</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">w</span></span></span>
<span class="r-in"><span>  <span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="sortdf.html">sortdf</a></span><span class="op">(</span><span class="va">w</span>, <span class="op">~</span> <span class="va">Sex</span><span class="op">/</span><span class="va">ses</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">coef</span>  <span class="op">~</span> <span class="va">ses</span> <span class="op">|</span> <span class="va">Sex</span>, <span class="va">w</span>,</span></span>
<span class="r-in"><span>     type <span class="op">=</span> <span class="st">'l'</span>,</span></span>
<span class="r-in"><span>     auto.key <span class="op">=</span> <span class="cn">T</span>,</span></span>
<span class="r-in"><span>     fit <span class="op">=</span> <span class="va">w</span><span class="op">$</span><span class="va">coef</span>,</span></span>
<span class="r-in"><span>     lower <span class="op">=</span> <span class="va">w</span><span class="op">$</span><span class="va">L2</span>,</span></span>
<span class="r-in"><span>     upper <span class="op">=</span> <span class="va">w</span><span class="op">$</span><span class="va">U2</span>,</span></span>
<span class="r-in"><span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     ylab <span class="op">=</span> <span class="st">'effect of ses (Public minus Catholic)'</span>,</span></span>
<span class="r-in"><span>     subscripts <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>     <span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/layer.html" class="external-link">layer</a></span><span class="op">(</span><span class="fu"><a href="panel.fit.html">gpanel.fit</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>     <span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/layer.html" class="external-link">layer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/panel.functions.html" class="external-link">panel.abline</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">0</span>,b<span class="op">=</span><span class="fl">0</span>,lwd <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span><span class="st">'black'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">###</span></span></span>
<span class="r-in"><span><span class="co">### Using walddf to create and plot a data frame with predicted values</span></span></span>
<span class="r-in"><span><span class="co">###</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">hs</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span> <span class="va"><a href="https://svn.r-project.org/R-packages/trunk/nlme/" class="external-link">nlme</a></span> <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html" class="external-link">lme</a></span><span class="op">(</span><span class="va">mathach</span> <span class="op">~</span> <span class="op">(</span><span class="va">ses</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">ses</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="va">Sex</span> <span class="op">*</span> <span class="va">Sector</span>, <span class="va">hs</span>, random <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span><span class="op">|</span><span class="va">school</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span> ses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">.1</span><span class="op">)</span>, Sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">hs</span><span class="op">$</span><span class="va">Sex</span><span class="op">)</span>, Sector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">hs</span><span class="op">$</span><span class="va">Sector</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">w</span> <span class="op">&lt;-</span> <span class="fu">walddf</span><span class="op">(</span><span class="va">fit</span>, <span class="fu"><a href="getX.html">getX</a></span><span class="op">(</span><span class="va">fit</span>,data<span class="op">=</span><span class="va">pred</span><span class="op">)</span><span class="op">)</span> <span class="co"># attaches data to wald.object so it can included in data frame</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://latticeextra.r-forge.r-project.org/" class="external-link">latticeExtra</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">coef</span> <span class="op">~</span> <span class="va">ses</span> <span class="op">|</span> <span class="va">Sector</span>, <span class="va">w</span>, groups <span class="op">=</span> <span class="va">Sex</span>,</span></span>
<span class="r-in"><span>     auto.key <span class="op">=</span> <span class="cn">T</span>, type <span class="op">=</span> <span class="st">'l'</span>,</span></span>
<span class="r-in"><span>     fit <span class="op">=</span> <span class="va">w</span><span class="op">$</span><span class="va">coef</span>,</span></span>
<span class="r-in"><span>     upper <span class="op">=</span> <span class="va">w</span><span class="op">$</span><span class="va">L</span>,</span></span>
<span class="r-in"><span>     lower <span class="op">=</span> <span class="va">w</span><span class="op">$</span><span class="va">U</span>,</span></span>
<span class="r-in"><span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     subscript <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>     <span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/layer.html" class="external-link">glayer</a></span><span class="op">(</span> <span class="fu"><a href="panel.fit.html">gpanel.fit</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="wald.html">wald</a></span><span class="op">(</span><span class="va">fit</span>, <span class="st">'ses'</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="wald.html">wald</a></span><span class="op">(</span> <span class="va">fit</span>, <span class="st">'Sex'</span><span class="op">)</span>  <span class="co"># sig. overall effect of Sex</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="wald.html">wald</a></span><span class="op">(</span> <span class="va">fit</span>, <span class="st">':Sex'</span><span class="op">)</span> <span class="co"># but no evidence of interaction with ses</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="wald.html">wald</a></span><span class="op">(</span> <span class="va">fit</span>, <span class="st">'\\^2'</span><span class="op">)</span> <span class="co"># nor of curvature</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># conditional effect of ses</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="getX.html">getX</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">###</span></span></span>
<span class="r-in"><span>  <span class="co">###  Effect of ses: Differentiating with respect to ses</span></span></span>
<span class="r-in"><span>  <span class="co">###</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">L</span> <span class="op">&lt;-</span> <span class="fu"><a href="Lfx.html">Lfx</a></span><span class="op">(</span><span class="va">fit</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>         <span class="fl">0</span>,</span></span>
<span class="r-in"><span>         <span class="fl">1</span>,</span></span>
<span class="r-in"><span>         <span class="fl">2</span> <span class="op">*</span> <span class="va">ses</span>,</span></span>
<span class="r-in"><span>         <span class="fl">0</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">0</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">2</span> <span class="op">*</span> <span class="va">ses</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">2</span> <span class="op">*</span> <span class="va">ses</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">0</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">2</span> <span class="op">*</span> <span class="va">ses</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="va">pred</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="wald.html">wald</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">L</span><span class="op">)</span>, <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">w</span> <span class="op">&lt;-</span> <span class="fu">walddf</span><span class="op">(</span><span class="va">fit</span>, <span class="va">L</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">coef</span> <span class="op">~</span> <span class="va">ses</span> <span class="op">|</span> <span class="va">Sector</span>, <span class="va">w</span>, groups <span class="op">=</span> <span class="va">Sex</span>,</span></span>
<span class="r-in"><span>     auto.key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="fl">2</span>, lines <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     type <span class="op">=</span> <span class="st">'l'</span>,</span></span>
<span class="r-in"><span>     fit <span class="op">=</span> <span class="va">w</span><span class="op">$</span><span class="va">coef</span>,</span></span>
<span class="r-in"><span>     upper <span class="op">=</span> <span class="va">w</span><span class="op">$</span><span class="va">L</span>,</span></span>
<span class="r-in"><span>     lower <span class="op">=</span> <span class="va">w</span><span class="op">$</span><span class="va">U</span>,</span></span>
<span class="r-in"><span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     ylab <span class="op">=</span> <span class="st">'estimate change in mathach per unit increase in ses'</span>,</span></span>
<span class="r-in"><span>     subscripts <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>     <span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/layer.html" class="external-link">glayer</a></span><span class="op">(</span> <span class="fu"><a href="panel.fit.html">gpanel.fit</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>     <span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/layer.html" class="external-link">layer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/panel.functions.html" class="external-link">panel.abline</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">0</span>,b<span class="op">=</span><span class="fl">0</span>,lwd <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span><span class="st">'black'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">###</span></span></span>
<span class="r-in"><span>  <span class="co">###  Difference in effect of ses between Sectors</span></span></span>
<span class="r-in"><span>  <span class="co">###</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">pred.d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span> ses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">.1</span><span class="op">)</span>, Sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">hs</span><span class="op">$</span><span class="va">Sex</span><span class="op">)</span>, Sector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">hs</span><span class="op">$</span><span class="va">Sector</span><span class="op">)</span>, Sector0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">hs</span><span class="op">$</span><span class="va">Sector</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">pred.d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">pred.d</span>, <span class="va">Sector</span> <span class="op">&gt;</span> <span class="va">Sector0</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pred.d</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">L</span> <span class="op">&lt;-</span> <span class="fu"><a href="Lfx.html">Lfx</a></span><span class="op">(</span><span class="va">fit</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>         <span class="fl">0</span>,</span></span>
<span class="r-in"><span>         <span class="fl">0</span>,</span></span>
<span class="r-in"><span>         <span class="fl">0</span> <span class="op">*</span> <span class="va">ses</span>,</span></span>
<span class="r-in"><span>         <span class="fl">0</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">0</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">0</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">0</span> <span class="op">*</span> <span class="va">ses</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">2</span> <span class="op">*</span> <span class="va">ses</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector0</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">0</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector0</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fl">2</span> <span class="op">*</span> <span class="va">ses</span> <span class="op">*</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="M.html">M</a></span><span class="op">(</span><span class="va">Sector0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="va">pred.d</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">w</span> <span class="op">&lt;-</span> <span class="fu">walddf</span><span class="op">(</span><span class="va">fit</span>, <span class="va">L</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">w</span></span></span>
<span class="r-in"><span>  <span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="sortdf.html">sortdf</a></span><span class="op">(</span><span class="va">w</span>, <span class="op">~</span> <span class="va">Sex</span><span class="op">/</span><span class="va">ses</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">coef</span>  <span class="op">~</span> <span class="va">ses</span> <span class="op">|</span> <span class="va">Sex</span>, <span class="va">w</span>,</span></span>
<span class="r-in"><span>     type <span class="op">=</span> <span class="st">'l'</span>,</span></span>
<span class="r-in"><span>     auto.key <span class="op">=</span> <span class="cn">T</span>,</span></span>
<span class="r-in"><span>     fit <span class="op">=</span> <span class="va">w</span><span class="op">$</span><span class="va">coef</span>,</span></span>
<span class="r-in"><span>     lower <span class="op">=</span> <span class="va">w</span><span class="op">$</span><span class="va">L2</span>,</span></span>
<span class="r-in"><span>     upper <span class="op">=</span> <span class="va">w</span><span class="op">$</span><span class="va">U2</span>,</span></span>
<span class="r-in"><span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     ylab <span class="op">=</span> <span class="st">'effect of ses (Public minus Catholic)'</span>,</span></span>
<span class="r-in"><span>     subscripts <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>     <span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/layer.html" class="external-link">layer</a></span><span class="op">(</span><span class="fu"><a href="panel.fit.html">gpanel.fit</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>     <span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/layer.html" class="external-link">layer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/panel.functions.html" class="external-link">panel.abline</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">0</span>,b<span class="op">=</span><span class="fl">0</span>,lwd <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span><span class="st">'black'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Georges Monette.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>


<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create a long file from a wide file — tolong • spida2</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create a long file from a wide file — tolong"><meta name="description" content="Uses a minimal number of arguments to create a long file
using stats::reshape. Produces output even
when long variable names and time values are not fully
crossed."><meta property="og:description" content="Uses a minimal number of arguments to create a long file
using stats::reshape. Produces output even
when long variable names and time values are not fully
crossed."><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">spida2</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.2.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/spida2.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/generalParametricSplines_v2.html">General Parametric Splines in carEx v.2</a></li>
    <li><a class="dropdown-item" href="../articles/generalParametricSplines.html">General Parametric Splines in carEx</a></li>
    <li><a class="dropdown-item" href="../articles/pdInd.html">pdInd</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gmonette/spida2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Create a long file from a wide file</h1>
      <small class="dont-index">Source: <a href="https://github.com/gmonette/spida2/blob/HEAD/R/tolong.R" class="external-link"><code>R/tolong.R</code></a></small>
      <div class="d-none name"><code>tolong.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Uses a minimal number of arguments to create a long file
using <code>stats::<a href="https://rdrr.io/r/stats/reshape.html" class="external-link">reshape</a></code>. Produces output even
when long variable names and time values are not fully
crossed.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tolong</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>  timevar <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>  idvar <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>  ids <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,</span>
<span>  valuepattern <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="va">numericalpattern</span><span class="op">)</span> <span class="st">"[0-9]+"</span> <span class="kw">else</span> <span class="st">".*"</span>,</span>
<span>  numericalpattern <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  expand <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  safe_sep <span class="op">=</span> <span class="st">"@3-2861-2579@"</span>,</span>
<span>  reverse <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tolong_old</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>  timevar <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>  idvar <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>  ids <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,</span>
<span>  expand <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  safe_sep <span class="op">=</span> <span class="st">"#%@!"</span>,</span>
<span>  reverse <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">long</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>  timevar <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>  idvar <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>  ids <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,</span>
<span>  valuepattern <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="va">numericalpattern</span><span class="op">)</span> <span class="st">"[0-9]+"</span> <span class="kw">else</span> <span class="st">".*"</span>,</span>
<span>  numericalpattern <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  expand <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  safe_sep <span class="op">=</span> <span class="st">"@3-2861-2579@"</span>,</span>
<span>  reverse <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>wide data frame</p></dd>


<dt id="arg-sep">sep<a class="anchor" aria-label="anchor" href="#arg-sep"></a></dt>
<dd><p>(default '_') single or multiple character separator between
long names and 'time' value. Variable names with this
separator are transformed to long variables. If the string
occurs multiple times in a variable name, only the last
occurrence is treated as a separator.</p></dd>


<dt id="arg-timevar">timevar<a class="anchor" aria-label="anchor" href="#arg-timevar"></a></dt>
<dd><p>(default 'time') names of variable in output
long file to identify occasions. Its values are taken
from the suffix following the 'sep' character in each
time-varying variable.</p></dd>


<dt id="arg-idvar">idvar<a class="anchor" aria-label="anchor" href="#arg-idvar"></a></dt>
<dd><p>(default: 'id') the variable name used in the
output long file to identify the provenance row in the
input wide file.
It may exist in the input wide file and must, in that
case, have a unique value in each row. If it does not
exist, it will be created with values equal to the row
numbers of the input wide file.</p></dd>


<dt id="arg-ids">ids<a class="anchor" aria-label="anchor" href="#arg-ids"></a></dt>
<dd><p>(default <code>1:nrow(data)</code>) values for idvar
in long file if the variable <code>idvar</code> does not exist
in the input wide file. Ignored if <code>idvar</code> exists
in <code>data</code>.</p></dd>


<dt id="arg-valuepattern">valuepattern<a class="anchor" aria-label="anchor" href="#arg-valuepattern"></a></dt>
<dd><p>a regular expression to match the form of time values
at the end of variable names immediately following
the separator.  Specifying this pattern can avoid
misinterpreting separators in variable names that
are not intended to turned into long variables.</p></dd>


<dt id="arg-numericalpattern">numericalpattern<a class="anchor" aria-label="anchor" href="#arg-numericalpattern"></a></dt>
<dd><p>(default FALSE) if TRUE,
<code>valuepattern</code> is set to "0-9+$" to match
numerical values as time values at the end of
variable names to be turned into long variables.
This parameter is only
necessary if the separator occurs in variable names where
it is not intended to identify a long variable.</p></dd>


<dt id="arg-expand">expand<a class="anchor" aria-label="anchor" href="#arg-expand"></a></dt>
<dd><p>(default TRUE): if 'time' values are
inconsistent, fill in missing 'time's with NAs.</p></dd>


<dt id="arg-safe-sep">safe_sep<a class="anchor" aria-label="anchor" href="#arg-safe-sep"></a></dt>
<dd><p>temporary safe? separator</p></dd>


<dt id="arg-reverse">reverse<a class="anchor" aria-label="anchor" href="#arg-reverse"></a></dt>
<dd><p>(default FALSE) if TRUE, the 'time' value
precedes the variable name</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional parameters are passed to
<code><a href="https://rdrr.io/r/stats/reshape.html" class="external-link">reshape</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>'long' file with each wide row repeated as many
times as there are distinct values for the 'timevar'
variable. The rownames show the provenance of each row
by combining the value of <code>id</code> with the value of <code>time</code>
separated by a period</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>tolong</code> is intended for the simple case in which
'wide' variables in the input data frame are separator string that
separates the name of the variable in the long file from
the value of the 'time' variable that identifies the
corresponding row in the long file, e.g <code>x_1, x_2,
x_3</code> or <code>brain.volume_left, brain.volume_right</code>.  Since
the separator ('_' by default) may occur in other variables,
<code>tolong</code> offers two mechanisms to avoid misinterpreting
those occurrences as separators. If there are multiple
occurrences of the separator string in a variable name, only the
last occurrence is interpreted as a separator.  Secondly,
the <code>valuepattern</code> parameter can specify a regular expression
to identify allowed 'time' value strings at the end of variable
names.  The common case where the 'time' values are numerical
can be specified with the <code>numericalpattern</code> parameter.</p>
<p><code><a href="https://rdrr.io/r/stats/reshape.html" class="external-link">reshape</a></code> does not work if long variable names
and time values are not fully crossed, e.g <code>x_1, x_2,
x_3, y_1, y_2</code>. By default <code>long</code> creates additional
variables with "NAs" so the set of variables given to
<code><a href="https://rdrr.io/r/stats/reshape.html" class="external-link">reshape</a></code> is fully crossed, e.g. adding a
variable <code>y_3 &lt;- NA</code>.</p>
<p>Compare the functionality of <code>tolong</code> with that of
<code><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">tidyr::gather</a></code> and of
<code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">tidyr::pivot_longer</a></code>. 'tolong' depends on the
format of variable names to identify variables whose values
become new variables in the long form of the data and which
labels are used as the indices of the indexing variable,
whose default name is 'time', which can be set to another
value with the "timevar" argument. "tolong" can handle many
'time-varying' variables. "gather" can only handle one.
"pivot_longer" can handle many and might be considered a
replacement for "to_long" which has the disadvantage of
frequently requiring the renaming of variables, an easier
task for those who have mastered the use of regular
expressions, but potentially challenging otherwise.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="towide.html">towide</a></code> for many examples using both
'towide' and 'tolong'.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>id <span class="op">=</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, id2<span class="op">=</span> <span class="fl">11</span><span class="op">:</span><span class="fl">20</span>, v_L <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, v_R <span class="op">=</span> <span class="fl">11</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">z</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    id id2 v_L v_R</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   a  11   1  11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   b  12   2  12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   c  13   3  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   d  14   4  14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   e  15   5  15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   f  16   6  16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   g  17   7  17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   h  18   8  18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   i  19   9  19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  j  20  10  20</span>
<span class="r-in"><span><span class="fu">tolong</span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     id id2 time  v</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a.L  a  11    L  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a.R  a  11    R 11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b.L  b  12    L  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b.R  b  12    R 12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c.L  c  13    L  3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c.R  c  13    R 13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d.L  d  14    L  4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d.R  d  14    R 14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e.L  e  15    L  5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e.R  e  15    R 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.L  f  16    L  6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.R  f  16    R 16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g.L  g  17    L  7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g.R  g  17    R 17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h.L  h  18    L  8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h.R  h  18    R 18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i.L  i  19    L  9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i.R  i  19    R 19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j.L  j  20    L 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j.R  j  20    R 20</span>
<span class="r-in"><span><span class="fu">tolong</span><span class="op">(</span><span class="va">z</span>, timevar <span class="op">=</span> <span class="st">'Side'</span>, idvar <span class="op">=</span> <span class="st">'idn'</span>, ids <span class="op">=</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     id id2 Side  v idn</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A.L  a  11    L  1   A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A.R  a  11    R 11   A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B.L  b  12    L  2   B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B.R  b  12    R 12   B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C.L  c  13    L  3   C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C.R  c  13    R 13   C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D.L  d  14    L  4   D</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D.R  d  14    R 14   D</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> E.L  e  15    L  5   E</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> E.R  e  15    R 15   E</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F.L  f  16    L  6   F</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F.R  f  16    R 16   F</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G.L  g  17    L  7   G</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G.R  g  17    R 17   G</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H.L  h  18    L  8   H</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H.R  h  18    R 18   H</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I.L  i  19    L  9   I</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I.R  i  19    R 19   I</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> J.L  j  20    L 10   J</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> J.R  j  20    R 20   J</span>
<span class="r-in"><span><span class="fu">tolong</span><span class="op">(</span><span class="va">z</span>, timevar <span class="op">=</span> <span class="st">'Side'</span>, idvar <span class="op">=</span> <span class="st">'idn'</span>, ids <span class="op">=</span> <span class="va">z</span><span class="op">$</span><span class="va">id2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      id id2 Side  v idn</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11.L  a  11    L  1  11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11.R  a  11    R 11  11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12.L  b  12    L  2  12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12.R  b  12    R 12  12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13.L  c  13    L  3  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13.R  c  13    R 13  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14.L  d  14    L  4  14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14.R  d  14    R 14  14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15.L  e  15    L  5  15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15.R  e  15    R 15  15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16.L  f  16    L  6  16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16.R  f  16    R 16  16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17.L  g  17    L  7  17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17.R  g  17    R 17  17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18.L  h  18    L  8  18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18.R  h  18    R 18  18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19.L  i  19    L  9  19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19.R  i  19    R 19  19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20.L  j  20    L 10  20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20.R  j  20    R 20  20</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># unbalanced times</span></span></span>
<span class="r-in"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>id <span class="op">=</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, id2<span class="op">=</span> <span class="fl">11</span><span class="op">:</span><span class="fl">20</span>, v_L <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, v_R <span class="op">=</span> <span class="fl">11</span><span class="op">:</span><span class="fl">20</span>, z_L <span class="op">=</span> <span class="fl">21</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">z</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    id id2 v_L v_R z_L</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   a  11   1  11  21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   b  12   2  12  22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   c  13   3  13  23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   d  14   4  14  24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   e  15   5  15  25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   f  16   6  16  26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   g  17   7  17  27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   h  18   8  18  28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   i  19   9  19  29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  j  20  10  20  30</span>
<span class="r-in"><span><span class="fu">tolong</span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     id id2 time  v  z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a.L  a  11    L  1 21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a.R  a  11    R 11 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b.L  b  12    L  2 22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b.R  b  12    R 12 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c.L  c  13    L  3 23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c.R  c  13    R 13 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d.L  d  14    L  4 24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d.R  d  14    R 14 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e.L  e  15    L  5 25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e.R  e  15    R 15 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.L  f  16    L  6 26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.R  f  16    R 16 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g.L  g  17    L  7 27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g.R  g  17    R 17 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h.L  h  18    L  8 28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h.R  h  18    R 18 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i.L  i  19    L  9 29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i.R  i  19    R 19 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j.L  j  20    L 10 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j.R  j  20    R 20 NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># a separator with multiple occurrences:</span></span></span>
<span class="r-in"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>id <span class="op">=</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, id2<span class="op">=</span> <span class="fl">11</span><span class="op">:</span><span class="fl">20</span>, v_a_L <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, v_a_R <span class="op">=</span> <span class="fl">11</span><span class="op">:</span><span class="fl">20</span>, z_L <span class="op">=</span> <span class="fl">21</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">z</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    id id2 v_a_L v_a_R z_L</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   a  11     1    11  21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   b  12     2    12  22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   c  13     3    13  23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   d  14     4    14  24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   e  15     5    15  25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   f  16     6    16  26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   g  17     7    17  27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   h  18     8    18  28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   i  19     9    19  29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  j  20    10    20  30</span>
<span class="r-in"><span><span class="co"># The previous version of tolong() would have produced an error </span></span></span>
<span class="r-in"><span><span class="co"># due to multiple occurrences of the default separator '_'</span></span></span>
<span class="r-in"><span><span class="co"># but the new version matches only the last occurrence in</span></span></span>
<span class="r-in"><span><span class="co"># each variable name. The sublast() function helps by</span></span></span>
<span class="r-in"><span><span class="co"># matching only the last occurrence to facilitate </span></span></span>
<span class="r-in"><span><span class="co"># replacing it with a new unique separator, but it is</span></span></span>
<span class="r-in"><span><span class="co"># no longer necessary to do this:</span></span></span>
<span class="r-in"><span><span class="va">zz</span> <span class="op">&lt;-</span> <span class="va">z</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">zz</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="sublast.html">sublast</a></span><span class="op">(</span><span class="st">'_'</span>, <span class="st">'__'</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">zz</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">tolong</span><span class="op">(</span><span class="va">zz</span>, sep <span class="op">=</span> <span class="st">'__'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     id id2 time v_a  z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a.L  a  11    L   1 21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a.R  a  11    R  11 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b.L  b  12    L   2 22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b.R  b  12    R  12 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c.L  c  13    L   3 23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c.R  c  13    R  13 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d.L  d  14    L   4 24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d.R  d  14    R  14 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e.L  e  15    L   5 25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e.R  e  15    R  15 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.L  f  16    L   6 26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.R  f  16    R  16 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g.L  g  17    L   7 27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g.R  g  17    R  17 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h.L  h  18    L   8 28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h.R  h  18    R  18 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i.L  i  19    L   9 29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i.R  i  19    R  19 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j.L  j  20    L  10 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j.R  j  20    R  20 NA</span>
<span class="r-in"><span><span class="co"># or, now,, with the same result:</span></span></span>
<span class="r-in"><span><span class="fu">tolong</span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     id id2 time v_a  z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a.L  a  11    L   1 21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a.R  a  11    R  11 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b.L  b  12    L   2 22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b.R  b  12    R  12 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c.L  c  13    L   3 23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c.R  c  13    R  13 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d.L  d  14    L   4 24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d.R  d  14    R  14 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e.L  e  15    L   5 25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e.R  e  15    R  15 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.L  f  16    L   6 26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.R  f  16    R  16 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g.L  g  17    L   7 27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g.R  g  17    R  17 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h.L  h  18    L   8 28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h.R  h  18    R  18 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i.L  i  19    L   9 29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i.R  i  19    R  19 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j.L  j  20    L  10 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j.R  j  20    R  20 NA</span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># - sep can use more than one character</span></span></span>
<span class="r-in"><span><span class="co"># - the character string is interpreted literally, </span></span></span>
<span class="r-in"><span><span class="co"># i.e. if special regular expression characters</span></span></span>
<span class="r-in"><span><span class="co"># they are interpreted literally.</span></span></span>
<span class="r-in"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>id <span class="op">=</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, id2<span class="op">=</span> <span class="fl">11</span><span class="op">:</span><span class="fl">20</span>, HPC_head_R <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, HPC_tail_R <span class="op">=</span> <span class="fl">11</span><span class="op">:</span><span class="fl">20</span>, HPC_head_L <span class="op">=</span> <span class="fl">21</span><span class="op">:</span><span class="fl">30</span>, HPC_tail_L <span class="op">=</span> <span class="fl">31</span><span class="op">:</span><span class="fl">40</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">z</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    id id2 HPC_head_R HPC_tail_R HPC_head_L HPC_tail_L</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   a  11          1         11         21         31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   b  12          2         12         22         32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   c  13          3         13         23         33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   d  14          4         14         24         34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   e  15          5         15         25         35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   f  16          6         16         26         36</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   g  17          7         17         27         37</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   h  18          8         18         28         38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   i  19          9         19         29         39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  j  20         10         20         30         40</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"(_[LR]$)"</span>,<span class="st">"_\\1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "id"          "id2"         "HPC_head__R" "HPC_tail__R" "HPC_head__L"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6] "HPC_tail__L"</span>
<span class="r-in"><span><span class="op">(</span><span class="va">zz</span> <span class="op">&lt;-</span> <span class="fu">tolong</span><span class="op">(</span><span class="va">z</span>, sep <span class="op">=</span> <span class="st">"__"</span>, timevar <span class="op">=</span> <span class="st">"Side"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     id id2 Side HPC_head HPC_tail</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a.R  a  11    R        1       11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a.L  a  11    L       21       31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b.R  b  12    R        2       12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b.L  b  12    L       22       32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c.R  c  13    R        3       13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c.L  c  13    L       23       33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d.R  d  14    R        4       14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d.L  d  14    L       24       34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e.R  e  15    R        5       15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e.L  e  15    L       25       35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.R  f  16    R        6       16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.L  f  16    L       26       36</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g.R  g  17    R        7       17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g.L  g  17    L       27       37</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h.R  h  18    R        8       18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h.L  h  18    L       28       38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i.R  i  19    R        9       19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i.L  i  19    L       29       39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j.R  j  20    R       10       20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j.L  j  20    L       30       40</span>
<span class="r-in"><span><span class="va">zz</span><span class="op">$</span><span class="va">id3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">zz</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">tolong</span><span class="op">(</span><span class="va">zz</span>, idvar <span class="op">=</span> <span class="st">'id3'</span> ,timevar <span class="op">=</span> <span class="st">'Part'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          id id2 Side id3 Part HPC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a.L.head  a  11    L a.L head  21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a.L.tail  a  11    L a.L tail  31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a.R.head  a  11    R a.R head   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a.R.tail  a  11    R a.R tail  11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b.L.head  b  12    L b.L head  22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b.L.tail  b  12    L b.L tail  32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b.R.head  b  12    R b.R head   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b.R.tail  b  12    R b.R tail  12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c.L.head  c  13    L c.L head  23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c.L.tail  c  13    L c.L tail  33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c.R.head  c  13    R c.R head   3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c.R.tail  c  13    R c.R tail  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d.L.head  d  14    L d.L head  24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d.L.tail  d  14    L d.L tail  34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d.R.head  d  14    R d.R head   4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d.R.tail  d  14    R d.R tail  14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e.L.head  e  15    L e.L head  25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e.L.tail  e  15    L e.L tail  35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e.R.head  e  15    R e.R head   5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e.R.tail  e  15    R e.R tail  15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.L.head  f  16    L f.L head  26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.L.tail  f  16    L f.L tail  36</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.R.head  f  16    R f.R head   6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.R.tail  f  16    R f.R tail  16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g.L.head  g  17    L g.L head  27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g.L.tail  g  17    L g.L tail  37</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g.R.head  g  17    R g.R head   7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g.R.tail  g  17    R g.R tail  17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h.L.head  h  18    L h.L head  28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h.L.tail  h  18    L h.L tail  38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h.R.head  h  18    R h.R head   8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h.R.tail  h  18    R h.R tail  18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i.L.head  i  19    L i.L head  29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i.L.tail  i  19    L i.L tail  39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i.R.head  i  19    R i.R head   9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i.R.tail  i  19    R i.R tail  19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j.L.head  j  20    L j.L head  30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j.L.tail  j  20    L j.L tail  40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j.R.head  j  20    R j.R head  10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j.R.tail  j  20    R j.R tail  20</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span> y.a <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, y.b <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, x.a<span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, time <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span></span>
<span class="r-in"><span>    x.b <span class="op">=</span> <span class="fl">11</span><span class="op">:</span><span class="fl">13</span>, x.c <span class="op">=</span> <span class="fl">21</span><span class="op">:</span><span class="fl">23</span>, id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'a'</span>,<span class="st">'a'</span>,<span class="st">'b'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dd</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   y.a y.b x.a time x.b x.c id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   1   1   1    1  11  21  a</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   2   2   2    2  12  22  a</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   3   3   3    3  13  23  b</span>
<span class="r-in"><span><span class="fu">tolong</span><span class="op">(</span><span class="va">dd</span>, sep <span class="op">=</span> <span class="st">'.'</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Variable time in data is replaced by a variable to mark occasions. Use the 'timevar' argument to specify a different variable name in the output data frame</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>idvar: id must have unique values. It will be replaced in the output data frame with a variable containing row numbers of the input data frame. Use the 'idvar' argument to specify a different variable name in the output data frame</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     time id  y  x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.a    a  1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.b    b  1  1 11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.c    c  1 NA 21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.a    a  2  2  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.b    b  2  2 12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.c    c  2 NA 22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.a    a  3  3  3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.b    b  3  3 13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.c    c  3 NA 23</span>
<span class="r-in"><span><span class="va">dl</span> <span class="op">&lt;-</span> <span class="fu">tolong</span><span class="op">(</span><span class="va">dd</span>, sep <span class="op">=</span> <span class="st">'.'</span>, timevar <span class="op">=</span> <span class="st">"type"</span>, idvar <span class="op">=</span> <span class="st">'patient'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dl</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     time id type  y  x patient</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.a    1  a    a  1  1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.b    1  a    b  1 11       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.c    1  a    c NA 21       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.a    2  a    a  2  2       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.b    2  a    b  2 12       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.c    2  a    c NA 22       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.a    3  b    a  3  3       3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.b    3  b    b  3 13       3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.c    3  b    c NA 23       3</span>
<span class="r-in"><span><span class="fu"><a href="towide.html">towide</a></span><span class="op">(</span><span class="va">dl</span>, idvar <span class="op">=</span> <span class="st">'patient'</span>, timevar <span class="op">=</span> <span class="st">'type'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   patient y_a x_a y_b x_b y_c x_c time id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       1   1   1   1  11  NA  21    1  a</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       2   2   2   2  12  NA  22    2  a</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       3   3   3   3  13  NA  23    3  b</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Long file with additional constants</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'A'</span>,<span class="st">'B'</span>,<span class="st">'C'</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 site <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'head'</span>,<span class="st">'neck'</span>,<span class="st">'jaw'</span>,<span class="st">'chest'</span><span class="op">)</span><span class="op">[</span></span></span>
<span class="r-in"><span>                   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                 sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'male'</span>,<span class="st">'female'</span>,<span class="st">'male'</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 var1 <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span>,</span></span>
<span class="r-in"><span>                 var2 <span class="op">=</span> <span class="fl">11</span><span class="op">:</span><span class="fl">18</span>,</span></span>
<span class="r-in"><span>                 invar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="towide.html">towide</a></span><span class="op">(</span><span class="va">dl</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'name'</span><span class="op">)</span>, <span class="st">'site'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   name var1_head var2_head var1_neck var2_neck var1_jaw var2_jaw var1_chest</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    A         1        11         2        12        3       13         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    B         4        14         5        15        6       16         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    C         7        17        NA        NA       NA       NA          8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   var2_chest    sex invar</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         NA   male     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         NA female     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         18   male     3</span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># Two indexing variable: e.g. hippocampal volume 2 sides x 3 sites</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="va">dl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, each <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 side <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'left'</span>,<span class="st">'right'</span><span class="op">)</span>, <span class="fl">9</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 site <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'head'</span>,<span class="st">'body'</span>,<span class="st">'tail'</span><span class="op">)</span>,each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 volume <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">18</span>,</span></span>
<span class="r-in"><span>                 sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'female'</span>,<span class="st">'male'</span>,<span class="st">'female'</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">43</span>, <span class="fl">69</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dl</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    name  side site volume    sex age</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     A  left head      1 female  25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     A right head      2 female  25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     A  left body      3 female  25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     A right body      4 female  25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     A  left tail      5 female  25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     A right tail      6 female  25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     B  left head      7   male  43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     B right head      8   male  43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     B  left body      9   male  43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10    B right body     10   male  43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11    B  left tail     11   male  43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12    B right tail     12   male  43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13    C  left head     13 female  69</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14    C right head     14 female  69</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15    C  left body     15 female  69</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16    C right body     16 female  69</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17    C  left tail     17 female  69</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18    C right tail     18 female  69</span>
<span class="r-in"><span><span class="op">(</span><span class="va">dlsite</span> <span class="op">&lt;-</span> <span class="fu"><a href="towide.html">towide</a></span><span class="op">(</span><span class="va">dl</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'name'</span>,<span class="st">'side'</span><span class="op">)</span>, <span class="st">'site'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   name  side volume_head volume_body volume_tail    sex age</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    A  left           1           3           5 female  25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    A right           2           4           6 female  25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    B  left           7           9          11   male  43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    B right           8          10          12   male  43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    C  left          13          15          17 female  69</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    C right          14          16          18 female  69</span>
<span class="r-in"><span><span class="op">(</span><span class="va">dlsite.side</span> <span class="op">&lt;-</span> <span class="fu"><a href="towide.html">towide</a></span><span class="op">(</span><span class="va">dlsite</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'name'</span><span class="op">)</span>, <span class="st">'side'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   name volume_head_left volume_body_left volume_tail_left volume_head_right</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    A                1                3                5                 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    B                7                9               11                 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    C               13               15               17                14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   volume_body_right volume_tail_right    sex age</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                 4                 6 female  25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                10                12   male  43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                16                18 female  69</span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># Flipping a data frame</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>vname <span class="op">=</span> </span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'v1'</span>,<span class="st">'v2'</span>,<span class="st">'v3'</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   country <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Angola'</span>,<span class="st">'Benin'</span>,<span class="st">'Chad'</span>,<span class="st">'Denmark'</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'ANG'</span>,<span class="st">'BEN'</span>,<span class="st">'CHA'</span>,<span class="st">'DEN'</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   val__2011 <span class="op">=</span> <span class="fl">2011</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.01</span>,<span class="fl">.12</span>,<span class="fl">.01</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   val__2012 <span class="op">=</span> <span class="fl">2012</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.01</span>,<span class="fl">.12</span>,<span class="fl">.01</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   val__2013 <span class="op">=</span> <span class="fl">2013</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.01</span>,<span class="fl">.12</span>,<span class="fl">.01</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   val__2014 <span class="op">=</span> <span class="fl">2014</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.01</span>,<span class="fl">.12</span>,<span class="fl">.01</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   val__2015 <span class="op">=</span> <span class="fl">2015</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.01</span>,<span class="fl">.12</span>,<span class="fl">.01</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">z</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    vname country code val__2011 val__2012 val__2013 val__2014 val__2015</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     v1  Angola  ANG   2011.01   2012.01   2013.01   2014.01   2015.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     v1   Benin  BEN   2011.02   2012.02   2013.02   2014.02   2015.02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     v1    Chad  CHA   2011.03   2012.03   2013.03   2014.03   2015.03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     v1 Denmark  DEN   2011.04   2012.04   2013.04   2014.04   2015.04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     v2  Angola  ANG   2011.05   2012.05   2013.05   2014.05   2015.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     v2   Benin  BEN   2011.06   2012.06   2013.06   2014.06   2015.06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     v2    Chad  CHA   2011.07   2012.07   2013.07   2014.07   2015.07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     v2 Denmark  DEN   2011.08   2012.08   2013.08   2014.08   2015.08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     v3  Angola  ANG   2011.09   2012.09   2013.09   2014.09   2015.09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10    v3   Benin  BEN   2011.10   2012.10   2013.10   2014.10   2015.10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11    v3    Chad  CHA   2011.11   2012.11   2013.11   2014.11   2015.11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12    v3 Denmark  DEN   2011.12   2012.12   2013.12   2014.12   2015.12</span>
<span class="r-in"><span><span class="va">z</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span>  <span class="fu">tolong</span><span class="op">(</span>sep<span class="op">=</span> <span class="st">'__'</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         vname country code time     val id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.2011     v1  Angola  ANG 2011 2011.01  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.2012     v1  Angola  ANG 2012 2012.01  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.2013     v1  Angola  ANG 2013 2013.01  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.2014     v1  Angola  ANG 2014 2014.01  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.2015     v1  Angola  ANG 2015 2015.01  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.2011     v1   Benin  BEN 2011 2011.02  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.2012     v1   Benin  BEN 2012 2012.02  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.2013     v1   Benin  BEN 2013 2013.02  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.2014     v1   Benin  BEN 2014 2014.02  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.2015     v1   Benin  BEN 2015 2015.02  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.2011     v1    Chad  CHA 2011 2011.03  3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.2012     v1    Chad  CHA 2012 2012.03  3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.2013     v1    Chad  CHA 2013 2013.03  3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.2014     v1    Chad  CHA 2014 2014.03  3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.2015     v1    Chad  CHA 2015 2015.03  3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.2011     v1 Denmark  DEN 2011 2011.04  4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.2012     v1 Denmark  DEN 2012 2012.04  4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.2013     v1 Denmark  DEN 2013 2013.04  4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.2014     v1 Denmark  DEN 2014 2014.04  4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.2015     v1 Denmark  DEN 2015 2015.04  4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.2011     v2  Angola  ANG 2011 2011.05  5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.2012     v2  Angola  ANG 2012 2012.05  5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.2013     v2  Angola  ANG 2013 2013.05  5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.2014     v2  Angola  ANG 2014 2014.05  5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.2015     v2  Angola  ANG 2015 2015.05  5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6.2011     v2   Benin  BEN 2011 2011.06  6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6.2012     v2   Benin  BEN 2012 2012.06  6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6.2013     v2   Benin  BEN 2013 2013.06  6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6.2014     v2   Benin  BEN 2014 2014.06  6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6.2015     v2   Benin  BEN 2015 2015.06  6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7.2011     v2    Chad  CHA 2011 2011.07  7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7.2012     v2    Chad  CHA 2012 2012.07  7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7.2013     v2    Chad  CHA 2013 2013.07  7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7.2014     v2    Chad  CHA 2014 2014.07  7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7.2015     v2    Chad  CHA 2015 2015.07  7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8.2011     v2 Denmark  DEN 2011 2011.08  8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8.2012     v2 Denmark  DEN 2012 2012.08  8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8.2013     v2 Denmark  DEN 2013 2013.08  8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8.2014     v2 Denmark  DEN 2014 2014.08  8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8.2015     v2 Denmark  DEN 2015 2015.08  8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9.2011     v3  Angola  ANG 2011 2011.09  9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9.2012     v3  Angola  ANG 2012 2012.09  9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9.2013     v3  Angola  ANG 2013 2013.09  9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9.2014     v3  Angola  ANG 2014 2014.09  9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9.2015     v3  Angola  ANG 2015 2015.09  9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10.2011    v3   Benin  BEN 2011 2011.10 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10.2012    v3   Benin  BEN 2012 2012.10 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10.2013    v3   Benin  BEN 2013 2013.10 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10.2014    v3   Benin  BEN 2014 2014.10 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10.2015    v3   Benin  BEN 2015 2015.10 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11.2011    v3    Chad  CHA 2011 2011.11 11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11.2012    v3    Chad  CHA 2012 2012.11 11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11.2013    v3    Chad  CHA 2013 2013.11 11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11.2014    v3    Chad  CHA 2014 2014.11 11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11.2015    v3    Chad  CHA 2015 2015.11 11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12.2011    v3 Denmark  DEN 2011 2011.12 12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12.2012    v3 Denmark  DEN 2012 2012.12 12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12.2013    v3 Denmark  DEN 2013 2013.12 12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12.2014    v3 Denmark  DEN 2014 2014.12 12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12.2015    v3 Denmark  DEN 2015 2015.12 12</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">z</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span>  <span class="fu">tolong</span><span class="op">(</span>sep<span class="op">=</span> <span class="st">'__'</span>, timevar <span class="op">=</span> <span class="st">'year'</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span>  <span class="va">.</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">'^id$'</span>,<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="towide.html">towide</a></span><span class="op">(</span>timevar <span class="op">=</span> <span class="st">'vname'</span>, idvar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'code'</span>,<span class="st">'year'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    code year  val_v1  val_v2  val_v3 country</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   ANG 2011 2011.01 2011.05 2011.09  Angola</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   ANG 2012 2012.01 2012.05 2012.09  Angola</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   ANG 2013 2013.01 2013.05 2013.09  Angola</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   ANG 2014 2014.01 2014.05 2014.09  Angola</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   ANG 2015 2015.01 2015.05 2015.09  Angola</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   BEN 2011 2011.02 2011.06 2011.10   Benin</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   BEN 2012 2012.02 2012.06 2012.10   Benin</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   BEN 2013 2013.02 2013.06 2013.10   Benin</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   BEN 2014 2014.02 2014.06 2014.10   Benin</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  BEN 2015 2015.02 2015.06 2015.10   Benin</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  CHA 2011 2011.03 2011.07 2011.11    Chad</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  CHA 2012 2012.03 2012.07 2012.11    Chad</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  CHA 2013 2013.03 2013.07 2013.11    Chad</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  CHA 2014 2014.03 2014.07 2014.11    Chad</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  CHA 2015 2015.03 2015.07 2015.11    Chad</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  DEN 2011 2011.04 2011.08 2011.12 Denmark</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  DEN 2012 2012.04 2012.08 2012.12 Denmark</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18  DEN 2013 2013.04 2013.08 2013.12 Denmark</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  DEN 2014 2014.04 2014.08 2014.12 Denmark</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20  DEN 2015 2015.04 2015.08 2015.12 Denmark</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Extracting chains from a stanfit object in the 'rstan' package</span></span></span>
<span class="r-in"><span><span class="co"># If 'mod' is a stanfit model</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/rstan/" class="external-link">rstan</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">spida2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://mc-stan.org/rstan/reference/stanfit-method-extract.html" class="external-link">extract</a></span><span class="op">(</span><span class="va">mod</span>, permute <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dl</span> <span class="op">&lt;-</span> <span class="fu">tolong</span><span class="op">(</span><span class="va">df</span>, sep <span class="op">=</span> <span class="st">':'</span>, reverse <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Georges Monette.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>


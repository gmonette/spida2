<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Panel functions for predicted values and SE box — panel.box • spida2</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Panel functions for predicted values and SE box — panel.box"><meta name="description" content="With 'layer' and 'glayer' in 'latticeExtra', these functions can be used to easily generate fitted values and
error boxes that have a reasonable appearance whether a plot uses 'groups' or not."><meta property="og:description" content="With 'layer' and 'glayer' in 'latticeExtra', these functions can be used to easily generate fitted values and
error boxes that have a reasonable appearance whether a plot uses 'groups' or not."><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">spida2</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.2.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/spida2.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/generalParametricSplines_v2.html">General Parametric Splines in carEx v.2</a></li>
    <li><a class="dropdown-item" href="../articles/generalParametricSplines.html">General Parametric Splines in carEx</a></li>
    <li><a class="dropdown-item" href="../articles/pdInd.html">pdInd</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gmonette/spida2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Panel functions for predicted values and SE box</h1>
      <small class="dont-index">Source: <a href="https://github.com/gmonette/spida2/blob/HEAD/R/gpanel.R" class="external-link"><code>R/gpanel.R</code></a></small>
      <div class="d-none name"><code>panel.box.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>With 'layer' and 'glayer' in 'latticeExtra', these functions can be used to easily generate fitted values and
error boxes that have a reasonable appearance whether a plot uses 'groups' or not.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">panel.box</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">se</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">y</span> <span class="op">-</span> <span class="va">se</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">y</span> <span class="op">+</span> <span class="va">se</span>,</span>
<span>  width <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">is.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span> <span class="kw">else</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span>,</span>
<span>  <span class="va">subscripts</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  <span class="va">type</span>,</span>
<span>  <span class="va">group.number</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  alpha.fit <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>  alpha.box <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  <span class="va">col</span>,</span>
<span>  <span class="va">col.line</span>,</span>
<span>  <span class="va">col.symbol</span>,</span>
<span>  border <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  <span class="va">font</span>,</span>
<span>  <span class="va">fontface</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x-y">x, y<a class="anchor" aria-label="anchor" href="#arg-x-y"></a></dt>
<dd><p>arguments passed by 'layer'</p></dd>


<dt id="arg-lower-upper">lower, upper<a class="anchor" aria-label="anchor" href="#arg-lower-upper"></a></dt>
<dd><p>FIXME</p></dd>


<dt id="arg-subscripts">subscripts<a class="anchor" aria-label="anchor" href="#arg-subscripts"></a></dt>
<dd><p>FIXME</p></dd>


<dt id="arg-group-number">group.number<a class="anchor" aria-label="anchor" href="#arg-group-number"></a></dt>
<dd><p>FIXME</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>FIXME</p></dd>


<dt id="arg-col">col<a class="anchor" aria-label="anchor" href="#arg-col"></a></dt>
<dd><p>FIXME</p></dd>


<dt id="arg-col-symbol">col.symbol<a class="anchor" aria-label="anchor" href="#arg-col-symbol"></a></dt>
<dd><p>is used to control color when using 'groups'</p></dd>


<dt id="arg-border">border<a class="anchor" aria-label="anchor" href="#arg-border"></a></dt>
<dd><p>default = FALSE for panel.band.</p></dd>


<dt id="arg-font">font<a class="anchor" aria-label="anchor" href="#arg-font"></a></dt>
<dd><p>FIXME</p></dd>


<dt id="arg-fontface">fontface<a class="anchor" aria-label="anchor" href="#arg-fontface"></a></dt>
<dd><p>FIXME</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>data frame to be used to add additional values of numeric variable</p></dd>


<dt id="arg-form">form<a class="anchor" aria-label="anchor" href="#arg-form"></a></dt>
<dd><p>formula evaluated in data. The first term defines the variable with values to be filled in and the remaining terms define the variables to be used for grouping determining the minima and maxima within which values are added.</p></dd>


<dt id="arg-xpd">xpd<a class="anchor" aria-label="anchor" href="#arg-xpd"></a></dt>
<dd><p>expansion factor to add points beyond minima and maxima. Default 1.0.</p></dd>


<dt id="arg-fit">fit<a class="anchor" aria-label="anchor" href="#arg-fit"></a></dt>
<dd><p>fitted values of a model, generally passed through 'layer' from a call to 'xyplot': e.g. <code>xyplot( y ~ x, data, groups = g, fit = data$yhat, lower = with(data, yhat - 2*se), upper = with(data, yhat + 2*se), subscripts = T)</code></p></dd>


<dt id="arg-dots">dots<a class="anchor" aria-label="anchor" href="#arg-dots"></a></dt>
<dd><p>FIXME</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The 'panel.bands', 'panel.fit', and 'panel.labels' functions are
invoked for their graphical effect.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Georges Monette <a href="mailto:georges@yorku.ca">georges@yorku.ca</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">spida2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://latticeextra.r-forge.r-project.org/" class="external-link">latticeExtra</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/" class="external-link">car</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">Prestige</span><span class="op">$</span><span class="va">Education</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">Prestige</span><span class="op">$</span><span class="va">education</span>,</span></span>
<span class="r-in"><span>         breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>,<span class="fl">8</span>,<span class="fl">12</span>,<span class="op">+</span><span class="cn">Inf</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'&lt; HS'</span>,<span class="st">'some HS'</span>,<span class="st">'some PS'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">Prestige</span><span class="op">$</span><span class="va">Gender</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">Prestige</span><span class="op">$</span><span class="va">women</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">10</span>, <span class="fl">50</span>, <span class="op">+</span><span class="cn">Inf</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Male'</span>,<span class="st">'Mixed'</span>,<span class="st">'Female'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">income</span> <span class="op">~</span> <span class="va">Gender</span> <span class="op">*</span> <span class="va">Education</span>, <span class="va">Prestige</span>,</span></span>
<span class="r-in"><span>      na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">Prestige</span>, <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>Education <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">Education</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           Gender <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">Gender</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">pred</span>, <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>, newdata <span class="op">=</span> <span class="va">pred</span>, se <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">pred</span></span></span>
<span class="r-in"><span>  <span class="op">(</span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span> <span class="va">fit</span> <span class="op">~</span> <span class="va">Education</span> <span class="op">|</span> <span class="va">Gender</span> , <span class="va">pred</span>,  </span></span>
<span class="r-in"><span>                subscripts <span class="op">=</span> <span class="cn">T</span>, width <span class="op">=</span> <span class="fl">.5</span>,</span></span>
<span class="r-in"><span>                fit <span class="op">=</span> <span class="va">pred</span><span class="op">$</span><span class="va">fit</span>,</span></span>
<span class="r-in"><span>                labels <span class="op">=</span> <span class="va">pred</span><span class="op">$</span><span class="va">Education</span>,</span></span>
<span class="r-in"><span>                lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">pred</span>, <span class="va">fit</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="va">se.fit</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">pred</span>, <span class="va">fit</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="va">se.fit</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="td.html">gd</a></span><span class="op">(</span><span class="fl">3</span>,pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/layer.html" class="external-link">layer</a></span><span class="op">(</span><span class="fu"><a href="panel.fit.html">panel.fit</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">(</span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/layer.html" class="external-link">layer</a></span><span class="op">(</span><span class="fu">panel.box</span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15000</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>         auto.key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>columns<span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co">###### Need to fix handling of width with factor predictor   </span></span></span>
<span class="r-in"><span>  <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/layer.html" class="external-link">layer</a></span><span class="op">(</span><span class="fu"><a href="panel.fit.html">panel.labels</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co"># NOTE: with groups use 'glayer' instead of 'layer' </span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Georges Monette.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

